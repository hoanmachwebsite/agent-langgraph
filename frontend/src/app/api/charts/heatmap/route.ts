export async function GET() {
  try {
    const getHeatmapData = {
      data: '{"samples":[{"id":"Tr03 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"36-45","condition":"day_1","disease":"COPD","race":"Hispanic","samplecollectiondate":"2024-06-01","samplelocation":"Lung Biopsy","sex":"F"}},{"id":"Tr08 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"36-45","condition":"day_1","disease":"COPD","race":"Hispanic","samplecollectiondate":"2024-06-01","samplelocation":"Lung Biopsy","sex":"F"}},{"id":"Tr11 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"36-45","condition":"day_10","disease":"COPD","race":"Hispanic","samplecollectiondate":"2024-06-10","samplelocation":"Lung Biopsy","sex":"F"}},{"id":"Tr16 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"36-45","condition":"day_10","disease":"COPD","race":"Hispanic","samplecollectiondate":"2024-06-10","samplelocation":"Lung Biopsy","sex":"F"}},{"id":"Tr17 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"36-45","condition":"day_1","disease":"Healthy","race":"Asian","samplecollectiondate":"2024-06-01","samplelocation":"Plasma","sex":"F"}},{"id":"Tr21 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"36-45","condition":"day_1","disease":"Asthma","race":"Asian","samplecollectiondate":"2024-06-01","samplelocation":"Nasal Swab","sex":"F"}},{"id":"Tr25 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"36-45","condition":"day_10","disease":"Healthy","race":"Asian","samplecollectiondate":"2024-06-10","samplelocation":"Plasma","sex":"F"}},{"id":"Tr29 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"36-45","condition":"day_10","disease":"Asthma","race":"Asian","samplecollectiondate":"2024-06-10","samplelocation":"Nasal Swab","sex":"F"}},{"id":"Tr19 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_1","disease":"Asthma","race":"Hispanic","samplecollectiondate":"2024-06-01","samplelocation":"Nasal Swab","sex":"F"}},{"id":"Tr20 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"45+","condition":"day_1","disease":"Healthy","race":"White","samplecollectiondate":"2024-06-01","samplelocation":"Plasma","sex":"M"}},{"id":"Tr23 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"45+","condition":"day_1","disease":"Asthma","race":"White","samplecollectiondate":"2024-06-01","samplelocation":"Nasal Swab","sex":"F"}},{"id":"Tr27 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"45+","condition":"day_10","disease":"Asthma","race":"Hispanic","samplecollectiondate":"2024-06-10","samplelocation":"Nasal Swab","sex":"F"}},{"id":"Tr28 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_10","disease":"Healthy","race":"White","samplecollectiondate":"2024-06-10","samplelocation":"Plasma","sex":"M"}},{"id":"Tr31 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_10","disease":"Asthma","race":"White","samplecollectiondate":"2024-06-10","samplelocation":"Nasal Swab","sex":"F"}},{"id":"Tr35 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_1","disease":"Healthy","race":"White","samplecollectiondate":"2024-06-01","samplelocation":"Plasma","sex":"M"}},{"id":"Tr36 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_1","disease":"Healthy","race":"White","samplecollectiondate":"2024-06-01","samplelocation":"Blood","sex":"F"}},{"id":"Tr38 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"45+","condition":"day_1","disease":"Lung Cancer","race":"Black","samplecollectiondate":"2024-06-01","samplelocation":"Blood","sex":"M"}},{"id":"Tr39 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"45+","condition":"day_1","disease":"Lung Cancer","race":"Black","samplecollectiondate":"2024-06-01","samplelocation":"Lung Biopsy","sex":"M"}},{"id":"Tr43 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"45+","condition":"day_10","disease":"Healthy","race":"White","samplecollectiondate":"2024-06-10","samplelocation":"Plasma","sex":"M"}},{"id":"Tr44 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"45+","condition":"day_10","disease":"Healthy","race":"White","samplecollectiondate":"2024-06-10","samplelocation":"Blood","sex":"F"}},{"id":"Tr46 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_10","disease":"Lung Cancer","race":"Black","samplecollectiondate":"2024-06-10","samplelocation":"Blood","sex":"M"}},{"id":"Tr47 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_10","disease":"Lung Cancer","race":"Black","samplecollectiondate":"2024-06-10","samplelocation":"Lung Biopsy","sex":"M"}},{"id":"Tr48 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"45+","condition":"day_1","disease":"COPD","race":"Hispanic","samplecollectiondate":"2024-06-01","samplelocation":"Lung Biopsy","sex":"M"}},{"id":"Tr50 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_1","disease":"COPD","race":"Black","samplecollectiondate":"2024-06-01","samplelocation":"Lung Biopsy","sex":"M"}},{"id":"Tr51 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_1","disease":"Lung Cancer","race":"Asian","samplecollectiondate":"2024-06-01","samplelocation":"Blood","sex":"F"}},{"id":"Tr53 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"45+","condition":"day_1","disease":"Lung Cancer","race":"White","samplecollectiondate":"2024-06-01","samplelocation":"Blood","sex":"M"}},{"id":"Tr56 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_10","disease":"COPD","race":"Hispanic","samplecollectiondate":"2024-06-10","samplelocation":"Lung Biopsy","sex":"M"}},{"id":"Tr58 Name","attributes":{"group":"ATH_064","treatment":"ATH_064","age":"45+","condition":"day_10","disease":"COPD","race":"Black","samplecollectiondate":"2024-06-10","samplelocation":"Lung Biopsy","sex":"M"}},{"id":"Tr59 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_10","disease":"Lung Cancer","race":"Asian","samplecollectiondate":"2024-06-10","samplelocation":"Blood","sex":"F"}},{"id":"Tr61 Name","attributes":{"group":"ATH_063","treatment":"ATH_063","age":"45+","condition":"day_10","disease":"Lung Cancer","race":"White","samplecollectiondate":"2024-06-10","samplelocation":"Blood","sex":"M"}}],"genes":[{"name":"TMEM189-UBE2V1","expressions":[-0.379719009483412,-0.379719009483412,2.5074410169876,-0.379719009483412,3.22095294351692,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,2.10164227081487,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,2.04265801524934,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412,-0.379719009483412]},{"name":"MMRN1","expressions":[1.22591987202218,2.45339145199633,-0.111706521783614,1.83745482252239,0.803119551669909,1.45979034688153,1.81381303445632,-0.278228871996473,-0.58931877335388,0.541717683770434,-0.238448374556095,-0.576747960502616,-1.06685574535782,-0.709337851100825,0.42892681596807,0.813873724943509,-0.053604133671592,-0.641219177920612,0.083402828290206,-0.755610157963624,-0.483644945716478,-2.09070761805054,-0.648061173809303,-1.08320762693194,-0.455351239684438,0.0759864055999165,-0.105580853373408,-0.775942549289653,-0.558621631083761,-0.315201331974166]},{"name":"FAXDC2","expressions":[0.560670469234605,1.43410691375227,-0.934868534414473,0.836701283332807,1.1218176582441,3.01615778416544,0.814354800718585,1.23064633992171,-0.906748378019383,1.29493935907156,-0.783716492318635,0.342911341597321,0.0582940823019251,-0.391026504727437,-0.88099960119973,-0.0057619832128582,-0.390373014400271,0.118062863062426,-0.0751814522804175,-0.213785025539993,0.0945295052971998,-1.00085753919924,-0.958354452991123,-1.25667142476658,-0.723271305063934,0.587323449402464,-0.356576147687936,-1.1902180970141,-1.48935057360571,0.0472446763393768]},{"name":"LTBP1","expressions":[1.26608463031521,1.97705749789043,-0.197883661323906,0.82225665325038,0.610682993346773,2.7633311398582,1.2581973831967,0.462356504650216,-0.8184066516861,1.07001730249162,-0.668202275207769,-0.384699815491812,-0.0091350897182688,0.177146354537079,-0.729979421927028,0.344301407193345,-0.0486142413848677,-0.259170547194706,-1.00553438205803,-0.688321706883488,-0.508719788175376,-0.327699937672527,-1.35178317239377,-1.6244024215165,-0.669266978180072,0.779359192610502,-0.783633011819452,-0.887128541708474,-0.943922648247613,0.375713233249269]},{"name":"ITGA2B","expressions":[1.34157121924768,1.72489162678286,-0.437012852095743,0.566749700172346,0.456902987189972,2.50175371182854,1.40674261288372,0.671640834609003,-1.1119944350042,0.857202722084478,-0.280446657576952,-0.203009489072589,0.26510128009927,-0.153656436725306,-1.16851032721933,0.247569374473173,-0.398666170115033,-0.642542164844488,0.502900496578928,-0.615979590899405,-0.031041957736042,0.345238552266244,-0.891096534308428,-1.52090386484303,-1.15007600712998,0.700416443681206,-0.613733201170255,-1.75054677941936,-1.12389035642918,0.50442526269189]},{"name":"SH3BGRL2","expressions":[1.05997824633328,2.1848786926031,-1.0004064289888,1.08527908218995,0.760532526499727,2.61344015946591,0.999190540003873,0.266370273820441,-0.808509237457134,1.46733880770158,-0.477005497959675,-0.312117762586888,0.449477891870507,-0.463358285353384,-0.755026675186364,0.283351516145976,-0.039691419908787,-0.76926332735934,0.141573303365926,-0.605998661790881,-0.752544930054221,-0.92370506266608,-0.835920784901038,-1.81783732224709,-0.595128377672158,0.193739190181918,-0.0744352695634804,-0.990061856262267,-0.603682884254056,0.3195435540295]},{"name":"C6orf25","expressions":[1.04998017932738,1.62205914111181,-0.524377762171134,0.939176367011522,0.0812436254802362,2.88047985618977,0.983199217290574,0.974007523568073,-0.910945463428769,1.10449006026913,-0.557111602992354,0.0965593398377293,-0.38702506001817,-0.857711392872944,-0.510319112921942,0.110737307890393,-0.165367347982076,-0.0726321037861121,-0.726221744022501,-0.766906444786651,-0.221594752794076,0.0720087602865014,-0.963850562518657,-1.61313659467494,-0.640470191248382,0.908979402992913,-0.544151180167765,-1.35426253089733,-1.06701471643038,1.06017778245819]},{"name":"MAP1A","expressions":[0.898665739348404,1.83862792299052,-0.220122899277184,-0.193210828200384,1.95728875690433,2.22828579728315,1.94235487645855,0.58180698704566,-0.303607224245219,0.710097158943373,-0.39436563801217,-1.37904075752599,-0.416612449224022,-0.447154269498852,-0.473578489838113,0.0358379179044524,0.825881688421065,-0.680401037542809,-0.254989521491312,-0.27393269434096,0.154402130479649,-0.699257946837771,-0.146784552173974,-1.73362053676273,-0.758771437550067,0.382734979747381,-0.439278855284571,-1.18692891829631,-1.10042284111361,-0.453903058310502]},{"name":"GPC2","expressions":[-2.0548217150221,-1.13192971920361,-0.682199988936061,-0.590584220915984,-1.14205792651557,-1.17026199457411,-0.486182714848924,-0.728126411675489,-0.0710900198374198,-0.645496017516886,0.40010711092871,-0.0453249648375009,0.581700224748364,-0.802861266067878,0.0913748723527559,0.33468127980894,0.872141520827617,0.178183527492821,0.905109514646417,-0.228092070730946,0.215288002251037,-0.138262332616193,-0.068855246259872,1.17359934056373,-0.490180608674347,-0.486554728076691,2.72327200121153,1.78981590164717,-0.12740035677946,1.82500900660994]},{"name":"ARHGEF10","expressions":[-0.885173444473703,-0.618573786508655,-0.838999472414722,-0.470265025774624,-1.07160574113381,-0.615288613982781,-0.676809593453024,-0.850863106224713,2.02971712748668,0.508145762518938,-0.962820649171795,1.22590999133423,1.12657406461793,-0.584916696632513,0.0778434048715528,2.83932618964051,0.555590886311316,0.166531640129592,-1.14139691378193,2.1434472239155,-0.470058993596358,0.015698931158178,0.151962928996179,-0.502270684451004,-0.387282848721441,-0.268135031957477,0.39865012034516,-0.691441495573988,0.125291993395926,-0.328788166869174]},{"name":"PPARG","expressions":[-1.16364123542866,-0.431616064230388,-1.16364123542866,-0.431278619897062,-1.16364123542866,-0.648412372413492,-0.327773260408036,-0.721798713085301,-0.0469545287651376,-0.6885262248236,0.468905806605231,0.172778471702545,0.457293815123426,-0.152456163897758,-0.154372725523899,0.756177818953913,-0.129860998378668,-0.115335805460665,-1.16364123542866,0.257340495534764,-0.189839600565598,-0.790663676822807,-1.16364123542866,0.0673667444599447,0.0551743615569337,-0.023274323297219,1.64521454423891,2.10374128454466,1.90999090864592,2.77638500334669]},{"name":"P2RY4","expressions":[-0.848604709651082,-0.848604709651082,-0.848604709651082,-0.848604709651082,-0.848604709651082,-0.848604709651082,-0.848604709651082,-0.348357729201443,-0.848604709651082,-0.310663422242759,0.14562878268233,0.163876953736491,-0.848604709651082,-0.848604709651082,0.838315941662194,0.938168109874203,1.17496464450502,-0.848604709651082,-0.283794811363261,0.372265049224051,0.456619011608508,3.33353372497735,0.45222982582546,-0.017851221456623,0.608318003073435,-0.848604709651082,0.859916729794637,1.17151112553628,-0.848604709651082,1.47718050722816]},{"name":"TNFSF12-TNFSF13","expressions":[-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,1.1659238106039,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,1.92280690114874,4.00492897910721,-0.419849893257024,-0.419849893257024,0.328707573320616,1.47435486651841,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,-0.419849893257024,1.17967530746969]},{"name":"RP11-497H16.5","expressions":[-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226,3.09719597597704,-0.459638124271226,1.53132582070044,1.32696789780352,-0.459638124271226,-0.459638124271226,-0.459638124271226,1.36882530588575,-0.459638124271226,2.71563525795376,-0.459638124271226,-0.459638124271226,0.991364724188891,-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226,-0.459638124271226]}],"metadata":{"contrast":"age","alternate_level":"36-45","reference_level":"45+","available_attributes":["group","treatment","age","condition","disease","race","samplecollectiondate","samplelocation","sex"]}}',
    };

    return Response.json(getHeatmapData);
  } catch (error) {
    console.error("Error fetching heatmap data:", error);
    return Response.json(
      {
        error: "Failed to fetch heatmap data",
        details: error instanceof Error ? error.message : "Unknown error",
      },
      { status: 500 }
    );
  }
}

export async function POST(request: Request) {
  try {
    const body = await request.json();
    // If data is provided in request body, use it; otherwise use default
    const chartData = body.data || body.chart_data;

    if (chartData) {
      // chartData should be a JSON string from artifact
      // Ensure it's returned as a string (API always returns data as JSON string)
      const dataString =
        typeof chartData === "string" ? chartData : JSON.stringify(chartData);

      return Response.json({
        data: dataString,
      });
    }

    // Fallback to default data if no data provided
    const getDEGsData = {
      data: '{"headers":["gene_id","baseMean","FoldChange","log2FoldChange","lfcSE","stat","pvalue","padj","gene_symbol","entrez_id","gene_biotype","gene_name"],"data":[["ENSG00000124208",4.89425621532338,7459608.15916677,22.8306684194194,3.39916981110424,6.71654247600026,1.86087082489127e-11,1.87101257088693e-7,"TMEM189-UBE2V1","NA","protein_coding","NA"]],"metadata":{"de_genes":14,"up_genes":8,"down_genes":6,"contrast":"age","alternate_level":"36-45","reference_level":"45+","fc_thres":"1.5","padj_thres":"0.05"}}',
    };

    return Response.json(getDEGsData);
  } catch (error) {
    console.error("Error processing heatmap data:", error);
    return Response.json(
      {
        error: "Failed to process heatmap data",
        details: error instanceof Error ? error.message : "Unknown error",
      },
      { status: 500 }
    );
  }
}
